{% extends "base.html" %}

{% block title %}{{ imovel.endereco_completo }} - ImobiPro{% endblock %}

{% block content %}
<div class="page-header">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
            <h2>üè† {{ imovel.endereco_completo }}</h2>
            <p>Detalhes completos do im√≥vel</p>
        </div>
        <div style="display: flex; gap: var(--spacing-sm);">
            <a href="{{ url_for('listar_imoveis') }}" class="btn btn-secondary">‚Üê Voltar</a>
            <a href="{{ url_for('editar_imovel', id=imovel.id) }}" class="btn btn-primary">‚úèÔ∏è Editar</a>
            <form action="{{ url_for('excluir_imovel', id=imovel.id) }}" method="POST" style="margin: 0;" onsubmit="return confirm('Tem certeza que deseja excluir este im√≥vel?\n\nEsta a√ß√£o n√£o pode ser desfeita.');">
                <button type="submit" class="btn btn-danger" style="padding: 0.5rem 1rem;">üóëÔ∏è Excluir</button>
            </form>
        </div>
    </div>
</div>

<!-- Informa√ß√µes principais -->
<div style="display: grid; grid-template-columns: 2fr 1fr; gap: var(--spacing-md); margin-bottom: var(--spacing-md);">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">üìã Informa√ß√µes do Im√≥vel</h3>
        </div>
        
        <div style="display: grid; gap: var(--spacing-md);">
            <div>
                <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                    ID do Im√≥vel
                </label>
                <div style="color: var(--text-primary); font-weight: 600; font-family: monospace;">
                    #{{ imovel.id }}
                </div>
            </div>
            
            <div>
                <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                    Endere√ßo Completo
                </label>
                <div style="color: var(--text-primary); font-weight: 600; font-size: 1.125rem;">
                    {{ imovel.endereco_completo }}
                </div>
            </div>
            
            <div>
                <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                    Status de Ocupa√ß√£o
                </label>
                <span class="badge badge-{{ imovel.ocupado|status_badge }}" style="font-size: 1rem;">
                    {{ imovel.ocupado }}
                </span>
            </div>
            <div>
                <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                    Descri√ß√£o do Im√≥vel
                </label>
                <div style="color: var(--text-primary); white-space: pre-wrap;">
                    {{ imovel.tipo_imovel }}
                </div>
            </div>
            
            {% if imovel.inscricao_imobiliaria %}
            <div>
                <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                    Inscri√ß√£o Imobili√°ria
                </label>
                <div style="color: var(--text-primary); font-family: monospace;">
                    {{ imovel.inscricao_imobiliaria }}
                </div>
            </div>
            {% endif %}

            {% if imovel.data_aquisicao %}
            <div>
                <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                    Data de Aquisi√ß√£o
                </label>
                <div style="color: var(--text-primary);">
                    {{ imovel.data_aquisicao|formatar_data }}
                </div>
            </div>
            {% endif %}

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-md);">
                {% if imovel.numero_hidrometro %}
                <div>
                    <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                        Hidr√¥metro
                    </label>
                    <div style="color: var(--text-primary); font-family: monospace;">
                        {{ imovel.numero_hidrometro }}
                    </div>
                </div>
                {% endif %}

                {% if imovel.numero_relogio_energia %}
                <div>
                    <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                        Rel√≥gio de Energia
                    </label>
                    <div style="color: var(--text-primary); font-family: monospace;">
                        {{ imovel.numero_relogio_energia }}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">üí∞ Valores</h3>
        </div>
        
        <div style="display: grid; gap: var(--spacing-md);">
            <div>
                <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                    Aluguel Pretendido
                </label>
                <div style="color: var(--success); font-weight: 700; font-size: 1.5rem;">
                    {{ imovel.aluguel_pretendido|formatar_moeda }}
                </div>
            </div>
            
            {% if imovel.condominio_sugerido %}
            <div>
                <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                    Condom√≠nio Sugerido
                </label>
                <div style="color: var(--text-primary); font-weight: 600;">
                    {{ imovel.condominio_sugerido|formatar_moeda }}
                    <span style="color: var(--text-muted); font-size: 0.875rem;">
                        (Venc. dia {{ imovel.dia_venc_condominio }})
                    </span>
                </div>
            </div>
            {% endif %}
            
            {% if imovel.valor_mercado %}
            <div>
                <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                    Valor de Mercado
                </label>
                <div style="color: var(--accent); font-weight: 700; font-size: 1.25rem;">
                    {{ imovel.valor_mercado|formatar_moeda }}
                </div>
            </div>
            {% endif %}

            <div>
                <label style="color: var(--text-muted); font-size: 0.875rem; display: block; margin-bottom: 0.25rem;">
                    IPTU Anual
                </label>
                <div style="color: var(--text-primary); font-weight: 600;">
                    {{ imovel.valor_iptu_anual|formatar_moeda }}
                    <div style="font-size: 0.875rem; color: var(--text-muted); font-weight: normal;">
                        Pagamento: {{ imovel.forma_pagamento_iptu }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Contratos -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">üìã Contratos</h3>
        <span class="badge badge-info">{{ contratos|length }}</span>
    </div>
    
    {% if contratos %}
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Per√≠odo</th>
                        <th>Valor Aluguel</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for contrato in contratos %}
                    <tr>
                        <td style="font-family: monospace;">#{{ contrato.id }}</td>
                        <td>
                            {{ contrato.inicio_contrato|formatar_data }}
                            at√©
                            {{ contrato.fim_contrato|formatar_data if contrato.fim_contrato else 'Indeterminado' }}
                        </td>
                        <td style="color: var(--success); font-weight: 600;">
                            {{ contrato.valor_aluguel|formatar_moeda }}
                        </td>
                        <td>
                            <span class="badge badge-{{ contrato.status_contrato|status_badge }}">
                                {{ contrato.status_contrato }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p style="text-align: center; color: var(--text-muted); padding: var(--spacing-lg);">
            Nenhum contrato registrado para este im√≥vel.
        </p>
    {% endif %}
</div>

<!-- Despesas -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">üí∏ Despesas Recentes</h3>
        <span class="badge badge-warning">{{ despesas|length }}</span>
    </div>
    
    {% if despesas %}
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Tipo</th>
                        <th>Descri√ß√£o</th>
                        <th>Valor</th>
                        <th>Vencimento</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for despesa in despesas[:10] %}
                    <tr>
                        <td>{{ despesa.tipo_despesa }}</td>
                        <td>{{ despesa.motivo_despesa or '-' }}</td>
                        <td style="color: var(--danger); font-weight: 600;">
                            {{ despesa.valor_previsto|formatar_moeda }}
                        </td>
                        <td>{{ despesa.vencimento_previsto|formatar_data }}</td>
                        <td>
                            {% if despesa.data_pagamento %}
                                <span class="badge badge-success">Pago</span>
                            {% else %}
                                <span class="badge badge-warning">Pendente</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p style="text-align: center; color: var(--text-muted); padding: var(--spacing-lg);">
            Nenhuma despesa registrada para este im√≥vel.
        </p>
    {% endif %}
</div>

{% if imovel.observacoes %}
<div class="card">
    <div class="card-header">
        <h3 class="card-title">üìù Observa√ß√µes</h3>
    </div>
    <p style="color: var(--text-secondary); white-space: pre-wrap;">{{ imovel.observacoes }}</p>
</div>
{% endif %}

{% endblock %}